<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SkyZero - AI 棋类游戏</title>
    <!-- 引入 Tailwind CSS 进行快速样式开发 -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- 引入 ONNX Runtime Web (锁定版本以避免 WASM 版本不匹配) -->
    <script src="https://cdn.jsdelivr.net/npm/onnxruntime-web@1.18.0/dist/ort.min.js"></script>
    <link rel="stylesheet" href="style.css">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600&display=swap" rel="stylesheet">
</head>
<body class="bg-gray-50 text-gray-800 font-inter">

    <!-- 顶部标题 -->
    <header class="text-center py-8">
        <h1 class="text-4xl font-bold text-gray-900 mb-2">SkyZero Playground</h1>
        <p class="text-gray-500 text-sm">纯浏览器端运行，基于 ONNX Runtime</p>
    </header>

    <main class="max-w-4xl mx-auto px-4 pb-12">
        
        <!-- 游戏切换 Tab -->
        <div class="flex justify-center mb-8">
            <div class="bg-white p-1 rounded-xl shadow-sm border border-gray-100 inline-flex">
                <button id="tab-ttt" onclick="switchGame('ttt')" class="px-6 py-2 rounded-lg text-sm font-medium transition-all bg-gray-900 text-white shadow-md">
                    井字棋
                </button>
                <button id="tab-c4" onclick="switchGame('c4')" class="px-6 py-2 rounded-lg text-sm font-medium transition-all text-gray-500 hover:text-gray-900">
                    四子棋
                </button>
                <button id="tab-gomoku" onclick="switchGame('gomoku')" class="px-6 py-2 rounded-lg text-sm font-medium transition-all text-gray-500 hover:text-gray-900">
                    9×9 五子棋
                </button>
            </div>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-12 gap-6">
            
            <!-- 左侧：游戏区 -->
            <div class="md:col-span-7 space-y-4">
                <div class="bg-white rounded-2xl shadow-sm border border-gray-100 p-6 relative overflow-hidden h-full flex flex-col justify-between">
                    
                    <div>
                        <!-- 状态条 -->
                        <div id="status-bar" class="status-bar mb-6 bg-blue-50 text-blue-600">
                            等待开始...
                        </div>

                        <!-- 棋盘容器 -->
                        <div class="flex justify-center relative min-h-[300px] items-center">
                            <!-- 井字棋盘 -->
                            <div id="ttt-board" class="grid grid-cols-3 gap-3 mx-auto hidden">
                                <!-- JS 生成格子 -->
                            </div>
                            
                            <!-- 四子棋盘 -->
                            <div id="c4-board" class="flex flex-col items-center hidden">
                                <!-- 顶部按钮行 -->
                                <div id="c4-buttons" class="grid grid-cols-7 gap-2 mb-2"></div>
                                <!-- 实际棋盘 -->
                                <div id="c4-grid" class="bg-blue-500 p-3 rounded-lg shadow-xl grid grid-cols-7 gap-2"></div>
                            </div>

                            <!-- 五子棋盘 -->
                            <div id="gomoku-board" class="relative bg-[#DEB887] rounded shadow-lg p-1 hidden">
                                <!-- JS 生成网格和棋子 -->
                            </div>
                            
                            <!-- 加载中遮罩 -->
                            <div id="loading-overlay" class="absolute inset-0 bg-white/80 flex items-center justify-center z-10 hidden">
                                <div class="flex flex-col items-center">
                                    <div class="animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900 mb-2"></div>
                                    <span class="text-xs font-semibold text-gray-600">加载模型中...</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 控制区 -->
                    <div class="mt-8 flex flex-col sm:flex-row flex-wrap items-center justify-center gap-4 border-t pt-6 border-gray-100">
                        
                        <!-- 先后手选择 -->
                        <div class="flex items-center space-x-2 bg-gray-50 px-3 py-1.5 rounded-lg border border-gray-200">
                            <span class="text-xs font-semibold text-gray-500">执子:</span>
                            <label class="inline-flex items-center cursor-pointer">
                                <input type="radio" name="playerSide" value="first" checked class="hidden peer" onchange="updatePlayerSide()">
                                <span class="px-3 py-1 rounded text-xs font-medium transition-colors peer-checked:bg-white peer-checked:text-gray-900 peer-checked:shadow-sm text-gray-400">先手 (黑)</span>
                            </label>
                            <label class="inline-flex items-center cursor-pointer">
                                <input type="radio" name="playerSide" value="second" class="hidden peer" onchange="updatePlayerSide()">
                                <span class="px-3 py-1 rounded text-xs font-medium transition-colors peer-checked:bg-white peer-checked:text-gray-900 peer-checked:shadow-sm text-gray-400">后手 (白)</span>
                            </label>
                        </div>

                        <div class="flex gap-2">
                            <button onclick="undoMove()" class="px-4 py-2 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-lg text-sm font-medium transition-colors whitespace-nowrap">
                                悔棋
                            </button>
                            <button onclick="resetGame()" class="px-4 py-2 bg-gray-900 hover:bg-gray-800 text-white rounded-lg text-sm font-medium transition-colors shadow-lg shadow-gray-200 whitespace-nowrap">
                                重置 / 新游戏
                            </button>
                        </div>
                    </div>

                </div>
            </div>

            <!-- 右侧：AI 分析区 -->
            <div class="md:col-span-5 space-y-4">
                <div class="bg-white rounded-2xl shadow-sm border border-gray-100 p-6 h-full flex flex-col">
                    <h3 class="text-sm font-bold text-gray-400 uppercase tracking-wider mb-4">AI 分析</h3>
                    
                    <!-- 胜率条 -->
                    <div class="mb-6">
                        <div class="flex justify-between text-sm mb-1">
                            <span class="text-gray-600">预估胜率</span>
                            <span id="winrate-text" class="font-mono font-bold text-gray-900">50.0%</span>
                        </div>
                        <div class="w-full bg-gray-100 rounded-full h-2.5 overflow-hidden">
                            <div id="winrate-bar" class="h-2.5 rounded-full bg-green-500 transition-all duration-500" style="width: 50%"></div>
                        </div>

                    </div>

                    <!-- 策略可视化区 -->
                    <div class="flex-1 bg-gray-50 rounded-xl p-4 border border-gray-100 flex flex-col">
                        <div class="flex items-center justify-between mb-2">
                            <span class="text-xs font-semibold text-gray-500">策略可视化</span>
                        </div>
                        <div id="policy-container" class="flex-1 w-full min-h-[200px] flex items-center justify-center relative">
                            <!-- Policy Chart / Heatmap renders here -->
                            <p class="text-gray-400 text-xs">等待分析...</p>
                        </div>
                    </div>

                    <div class="mt-4 pt-4 border-t border-gray-100">
                         <div class="text-xs text-gray-300 font-mono text-center">
                            推理耗时: <span id="inference-time">0</span>ms
                         </div>
                    </div>
                </div>
            </div>

        </div>
    </main>

    <script src="script.js"></script>
</body>
</html>